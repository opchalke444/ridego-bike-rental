<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Bikes - RideGo</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="brand-logo">
                <img src="../assets/images/logo.png" alt="RideGo" style="height: 70px; width: auto;">
            </a>
            <ul class="nav-menu">
                <li><a href="user-dashboard.html">Dashboard</a></li>
                <li><a href="search-bike.html">Search Bikes</a></li>
                <li><a href="my-bookings.html">My Bookings</a></li>
                <li><a href="user-notifications.html">Notifications</a></li>
                <li><a href="profile.html">Profile</a></li>
                <li><a href="#" class="btn btn-primary btn-small" id="logoutBtn">Logout</a></li>
            </ul>
        </div>
    </nav>

    <!-- Search Section -->
    <section class="section" style="padding-top: 120px;">
        <div class="section-container">
            <div class="section-header">
                <span class="section-tag">Find Your Ride</span>
                <h2 class="section-title">Search Available Bikes</h2>
                <p class="section-subtitle">Discover the perfect bike for your adventure across India's most scenic destinations</p>
            </div>

            <!-- Search Filters -->
            <div class="feature-card mb-4" style="max-width: 900px; margin: 0 auto;">
                <form class="form-row" id="searchForm">
                    <div class="form-group" style="grid-column: span 2;">
                        <label>Destination</label>
                        <select class="form-control" id="destinationFilter">
                            <option value="">All Destinations</option>
                            <option value="alibaug">Alibaug</option>
                            <option value="darjeeling">Darjeeling</option>
                            <option value="goa">Goa</option>
                            <option value="jaipur">Jaipur</option>
                            <option value="kochi">Kochi</option>
                            <option value="leh-ladakh">Leh Ladakh</option>
                            <option value="manali">Manali</option>
                            <option value="ooty">Ooty</option>
                        </select>
                    </div>
                </form>
                <div class="mt-3 text-center">
                    <button class="btn btn-primary btn-large" id="searchBtn">Search Bikes</button>
                </div>
            </div>

            <!-- Available Bikes Grid -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 id="resultsTitle">Available Bikes (0)</h3>
                <div>
                    <select class="form-control" id="sortFilter" style="display: inline-block; width: auto;">
                        <option value="default">Sort By: Default</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="rating">Highest Rated</option>
                        <option value="name">Name: A-Z</option>
                    </select>
                </div>
            </div>
            
            <div class="vehicles-grid" id="bikesGrid">
                <!-- Bikes will be dynamically loaded here -->
            </div>

            <!-- No Results Message -->
            <div id="noResults" style="display: none; text-align: center; padding: 3rem;">
                <h3>No bikes found</h3>
                <p>Try adjusting your search filters or select a different destination.</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-section">
                <h4 class="footer-title">About RideGo</h4>
                <p class="footer-description">Your trusted companion for bike and scooter rentals across India's most scenic destinations.</p>
            </div>
            <div class="footer-section">
                <h4 class="footer-title">Quick Links</h4>
                <ul class="footer-links">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="search-bike.html">Search Bikes</a></li>
                    <li><a href="my-bookings.html">My Bookings</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4 class="footer-title">Contact</h4>
                <ul class="footer-links">
                    <li>üìß ridego@gmail.com</li>
                    <li>üìû +91 9324072928</li>
                    <li>üìç Thane, India</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 RideGo. All rights reserved.</p>
        </div>
    </footer>

    <!-- Load bikes data -->
    <script src="../assets/js/bikes-data.js"></script>
    
    <script>
        let allBikes = [];
        let filteredBikes = [];
        let currentDestination = '';

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Get URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const destinationParam = urlParams.get('destination');
            
            if (destinationParam) {
                document.getElementById('destinationFilter').value = destinationParam;
                currentDestination = destinationParam;
            }

            // Load all bikes
            loadBikes();

            // Event listeners
            document.getElementById('searchBtn').addEventListener('click', filterBikes);
            document.getElementById('destinationFilter').addEventListener('change', filterBikes);
            document.getElementById('sortFilter').addEventListener('change', sortBikes);
        });

        function loadBikes() {
            if (typeof getAllBikes === 'function') {
                allBikes = getAllBikes();
            } else {
                allBikes = [];
            }
            filteredBikes = [...allBikes];
            
            // If destination is pre-selected, filter immediately
            if (currentDestination) {
                filterBikes();
            } else {
                displayBikes(filteredBikes);
            }
        }

        function filterBikes() {
            const destination = document.getElementById('destinationFilter').value;

            // Filter by destination
            if (destination) {
                filteredBikes = allBikes.filter(bike => 
                    bike.locations.some(loc => loc.toLowerCase().replace(/\s+/g, '-') === destination)
                );
            } else {
                filteredBikes = [...allBikes];
            }

            displayBikes(filteredBikes);
        }

        function sortBikes() {
            const sortType = document.getElementById('sortFilter').value;
            
            switch(sortType) {
                case 'price-low':
                    filteredBikes.sort((a, b) => a.dailyRate - b.dailyRate);
                    break;
                case 'price-high':
                    filteredBikes.sort((a, b) => b.dailyRate - a.dailyRate);
                    break;
                case 'rating':
                    filteredBikes.sort((a, b) => b.rating - a.rating);
                    break;
                case 'name':
                    filteredBikes.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                default:
                    filteredBikes = [...allBikes];
                    filterBikes();
                    return;
            }
            
            displayBikes(filteredBikes);
        }

        function displayBikes(bikes) {
            const grid = document.getElementById('bikesGrid');
            const noResults = document.getElementById('noResults');
            const resultsTitle = document.getElementById('resultsTitle');

            if (bikes.length === 0) {
                grid.innerHTML = '';
                noResults.style.display = 'block';
                resultsTitle.textContent = 'Available Bikes (0)';
                return;
            }

            noResults.style.display = 'none';
            resultsTitle.textContent = `Available Bikes (${bikes.length})`;

            grid.innerHTML = bikes.map((bike, index) => `
                <div class="vehicle-card">
                    ${index < 3 ? '<div class="vehicle-badge">Featured</div>' : ''}
                    <div class="vehicle-image">
                        <img src="../assets/images/vehicles/${bike.image}" alt="${bike.name}" onerror="this.src='../assets/images/vehicles/placeholder.png'">
                    </div>
                    <div class="vehicle-content">
                        <h4 class="vehicle-name">${bike.name}</h4>
                        <p class="vehicle-category">${bike.category}</p>
                        <div class="vehicle-rating">
                            <span>‚≠ê ${bike.rating}</span>
                            <span>(${bike.reviews} reviews)</span>
                        </div>
                        <div class="vehicle-details">
                            <span style="display: block; width: 100%;">üìç ${bike.locations.join(', ')}</span>
                            <span>‚ö° ${bike.engine}</span>
                            <span>‚õΩ ${bike.mileage}</span>
                        </div>
                        <div class="vehicle-footer">
                            <span class="vehicle-price">‚Çπ${bike.dailyRate.toLocaleString()}/day</span>
                            <a href="bike-details.html?bike=${bike.id}&destination=${document.getElementById('destinationFilter').value || bike.locations[0].toLowerCase().replace(/\s+/g, '-')}" class="btn btn-primary btn-small">View Details</a>
                        </div>
                    </div>
                </div>
            `).join('');
        }
    </script>
    <script src="../assets/js/auth.js"></script>
    <script src="../assets/js/auth-guard.js"></script>
</body>
</html>
