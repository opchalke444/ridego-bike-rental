<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - RideGo</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        /* Remove globe emoji and fix logo display */
        .auth-brand-logo::before {
            content: none !important;
            display: none !important;
        }
        
        .auth-brand-logo {
            text-align: center;
            margin-bottom: 2rem !important;
            display: block !important;
            line-height: 0;
        }
        
        .auth-brand-logo img {
            height: 70px !important;
            width: auto !important;
            display: inline-block !important;
            object-fit: contain;
        }
    </style>
</head>
<body class="auth-page">
    <div class="auth-container">
        <!-- Left Side - Branding -->
        <div class="auth-brand">
            <div class="auth-brand-logo">
                <img src="assets/images/logo-purple.png" alt="RideGo Logo">
            </div>
            <div class="auth-brand-content">
                <h1 class="auth-brand-title">Welcome Back, Explorer!</h1>
                <p class="auth-brand-description">Sign in to continue your journey and access amazing rides across incredible destinations.</p>
                <ul class="auth-brand-features">
                    <li>Instant access to 25+ Bike Variants</li>
                    <li>Real-time booking across 10+ destinations</li>
                    <li>Verified vendors and secure payments</li>
                    <li>24/7 travel support and roadside assistance</li>
                </ul>
            </div>
        </div>

        <!-- Right Side - Login Form -->
        <div class="auth-form-section">
            <a href="index.html" class="back-link">‚Üê Back to Home</a>
            
            <div class="form-header">
                <h2>Login to RideGo</h2>
                <p>New to RideGo? <a href="register.html">Create an account</a></p>
            </div>

            <!-- Role Selection Tabs -->
            <div class="role-tabs">
                <button class="role-tab active" onclick="selectRole('user')">Traveler</button>
                <button class="role-tab" onclick="selectRole('vendor')">Vendor</button>
                <button class="role-tab" onclick="selectRole('admin')">Admin</button>
            </div>

            <!-- Login Form -->
            <form id="loginForm">
                <input type="hidden" id="roleInput" name="role" value="user">
                
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        class="form-control" 
                        placeholder="yourname@example.com"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="password">Password</label>
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        class="form-control" 
                        placeholder="Enter your password"
                        required
                    >
                </div>

                <div class="form-options">
                    <div class="checkbox-group">
                        <input type="checkbox" id="remember" name="remember">
                        <label for="remember">Remember me</label>
                    </div>
                    <a href="#" class="forgot-link">Forgot password?</a>
                </div>

                <button type="submit" class="btn-submit">Login to Account</button>
            </form>

            <p class="text-center mt-3" style="color: var(--gray); font-size: 0.9rem;">
                By logging in, you agree to our 
                <a href="#" style="color: var(--primary); font-weight: 600;">Terms of Service</a> and 
                <a href="#" style="color: var(--primary); font-weight: 600;">Privacy Policy</a>
            </p>
        </div>
    </div>

    <script src="assets/js/auth.js"></script>
    <script>
        function selectRole(role) {
            document.querySelectorAll('.role-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            document.getElementById('roleInput').value = role;
            
            const formHeader = document.querySelector('.form-header h2');
            const brandTitle = document.querySelector('.auth-brand-title');
            const brandDesc = document.querySelector('.auth-brand-description');
            
            if (role === 'vendor') {
                formHeader.textContent = 'Vendor Login';
                brandTitle.textContent = 'Welcome Back, Partner!';
                brandDesc.textContent = 'Access your vendor dashboard to manage bookings, vehicles, and grow your rental business.';
            } else if (role === 'admin') {
                formHeader.textContent = 'Admin Login';
                brandTitle.textContent = 'Admin Portal Access';
                brandDesc.textContent = 'Manage the platform, verify vendors, and ensure quality service for all travelers.';
            } else {
                formHeader.textContent = 'Login to RideGo';
                brandTitle.textContent = 'Welcome Back, Explorer!';
                brandDesc.textContent = 'Sign in to continue your journey and access amazing rides across incredible destinations.';
            }
        }

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const role = document.getElementById('roleInput').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // Debug: Check if users exist
            const users = JSON.parse(localStorage.getItem('ridego_users') || '[]');
            console.log('Total users in system:', users.length);
            console.log('Attempting login with:', { email, role });
            
            const result = AuthService.login(email, password, role);
            console.log('Login result:', result);
            
            if (result.success) {
                const roleText = role === 'user' ? 'Traveler' : role === 'vendor' ? 'Vendor' : 'Admin';
                alert(`Login successful as ${roleText}!\nEmail: ${email}\n\nRedirecting...`);
                
                const redirectUrl = sessionStorage.getItem('ridego_redirect_after_login');
                
                if (redirectUrl && role === 'user') {
                    sessionStorage.removeItem('ridego_redirect_after_login');
                    window.location.href = redirectUrl;
                } else {
                    if (role === 'user') {
                        window.location.href = 'user/user-dashboard.html';
                    } else if (role === 'vendor') {
                        window.location.href = 'vendor/vendor-dashboard.html';
                    } else if (role === 'admin') {
                        window.location.href = 'admin/admin-dashboard.html';
                    }
                }
            } else {
                alert('Login Failed!\n\n' + result.error + '\n\nPlease check:\n- Email: user@demo.com\n- Password: password123\n- Role: User (Traveler)\n\nThen try again.');
            }
        });

        document.getElementById('email').addEventListener('blur', function() {
            const email = this.value;
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (email && !emailRegex.test(email)) {
                this.style.borderColor = 'var(--error)';
            } else {
                this.style.borderColor = '';
            }
        });

        const passwordInput = document.getElementById('password');
        passwordInput.addEventListener('focus', function() {
            this.setAttribute('autocomplete', 'current-password');
        });
    </script>
</body>
</html>
