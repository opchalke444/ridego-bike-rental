<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - RideGo</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        /* Remove globe emoji and fix logo display */
        .auth-brand-logo::before {
            content: none !important;
            display: none !important;
        }
        
        .auth-brand-logo {
            text-align: center;
            margin-bottom: 2rem !important;
            display: block !important;
            line-height: 0;
        }
        
        .auth-brand-logo img {
            height: 70px !important;
            width: auto !important;
            display: inline-block !important;
            object-fit: contain;
        }
    </style>
</head>
<body class="auth-page">
    <div class="auth-container">
        <!-- Left Side - Branding -->
        <div class="auth-brand">
            <div class="auth-brand-logo">
                <img src="assets/images/logo-purple.png" alt="RideGo Logo">
            </div>
            <div class="auth-brand-content">
                <h1 class="auth-brand-title">Begin Your Journey Today</h1>
                <p class="auth-brand-description">Join thousands of travelers and vendors who trust RideGo for unforgettable two-wheeled adventures.</p>
                <ul class="auth-brand-features">
                    <li>Access to 500+ bikes across 10+ destinations</li>
                    <li>Secure booking and verified vendors</li>
                    <li>Flexible rental plans for every budget</li>
                    <li>24/7 support and roadside assistance</li>
                </ul>
            </div>
        </div>

        <!-- Right Side - Registration Form -->
        <div class="auth-form-section">
            <a href="index.html" class="back-link">‚Üê Back to Home</a>
            
            <div class="form-header">
                <h2>Create Your Account</h2>
                <p>Already have an account? <a href="login.html">Sign in</a></p>
            </div>

            <!-- Role Selection -->
            <div class="form-group">
                <label>I want to join as <span class="required">*</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="userRole" name="role" value="user" checked>
                        <label for="userRole">
                            <span>Traveler</span>
                        </label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="vendorRole" name="role" value="vendor">
                        <label for="vendorRole">
                            <span>Vendor</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Registration Form -->
            <form id="registerForm">
                <!-- Personal Information -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName">First Name <span class="required">*</span></label>
                        <input 
                            type="text" 
                            id="firstName" 
                            name="firstName" 
                            class="form-control" 
                            placeholder="John"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="lastName">Last Name <span class="required">*</span></label>
                        <input 
                            type="text" 
                            id="lastName" 
                            name="lastName" 
                            class="form-control" 
                            placeholder="Doe"
                            required
                        >
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="email">Email Address <span class="required">*</span></label>
                        <input 
                            type="email" 
                            id="email" 
                            name="email" 
                            class="form-control" 
                            placeholder="john.doe@example.com"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number <span class="required">*</span></label>
                        <input 
                            type="tel" 
                            id="phone" 
                            name="phone" 
                            class="form-control" 
                            placeholder="9876543210"
                            required
                        >
                    </div>
                </div>

                <!-- Location Information -->
                <div class="form-group">
                    <label for="address">Street Address <span class="required">*</span></label>
                    <input 
                        type="text" 
                        id="address" 
                        name="address" 
                        class="form-control" 
                        placeholder="123 Main Street"
                        required
                    >
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="city">City <span class="required">*</span></label>
                        <input 
                            type="text" 
                            id="city" 
                            name="city" 
                            class="form-control" 
                            placeholder="Mumbai"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="pincode">Pincode <span class="required">*</span></label>
                        <input 
                            type="text" 
                            id="pincode" 
                            name="pincode" 
                            class="form-control" 
                            placeholder="400001"
                            maxlength="6"
                            required
                        >
                    </div>
                </div>



                <!-- Vendor-specific fields (hidden by default) -->
                <div id="vendorFields" class="vendor-fields">
                    <div class="form-group">
                        <label for="businessName">Business/Shop Name <span class="required">*</span></label>
                        <input 
                            type="text" 
                            id="businessName" 
                            name="businessName" 
                            class="form-control" 
                            placeholder="Your rental shop name"
                        >
                    </div>

                    <div class="form-group">
                        <label for="vendorDestination">Operating Destination <span class="required">*</span></label>
                        <select id="vendorDestination" name="vendorDestination" class="form-control">
                            <option value="">Which destination do you operate in?</option>
                            <option value="leh-ladakh">Leh Ladakh</option>
                            <option value="goa">Goa</option>
                            <option value="jaipur">Jaipur</option>
                            <option value="manali">Manali</option>
                            <option value="kochi">Kochi</option>
                            <option value="alibaug">Alibaug</option>
                            <option value="ooty">Ooty</option>
                            <option value="darjeeling">Darjeeling</option>
                        </select>
                        <small style="color: #6B7280; font-size: 0.875rem; margin-top: 0.5rem; display: block;">
                            Please confirm that you really belong to this destination
                        </small>
                    </div>
                </div>

                <!-- Password -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="password">Password <span class="required">*</span></label>
                        <input 
                            type="password" 
                            id="password" 
                            name="password" 
                            class="form-control" 
                            placeholder="Minimum 8 characters"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">Confirm Password <span class="required">*</span></label>
                        <input 
                            type="password" 
                            id="confirmPassword" 
                            name="confirmPassword" 
                            class="form-control" 
                            placeholder="Re-enter password"
                            required
                        >
                    </div>
                </div>

                <!-- Terms and Conditions -->
                <div class="checkbox-group">
                    <input type="checkbox" id="terms" name="terms" required>
                    <label for="terms">
                        I agree to RideGo's <a href="#" target="_blank">Terms of Service</a> and <a href="#" target="_blank">Privacy Policy</a>
                    </label>
                </div>


                <button type="submit" class="btn-submit">Create Account</button>
            </form>
        </div>
    </div>

    <script src="assets/js/auth.js"></script>
    <script>
        // Toggle vendor-specific fields based on role selection
        const roleInputs = document.querySelectorAll('input[name="role"]');
        const vendorFields = document.getElementById('vendorFields');

        roleInputs.forEach(input => {
            input.addEventListener('change', function() {
                if (this.value === 'vendor') {
                    vendorFields.classList.add('active');
                    document.getElementById('businessName').setAttribute('required', 'required');
                    document.getElementById('vendorDestination').setAttribute('required', 'required');
                    
                    // Update branding text
                    document.querySelector('.auth-brand-title').textContent = 'Grow Your Rental Business';
                    document.querySelector('.auth-brand-description').textContent = 'Partner with RideGo to reach thousands of travelers and maximize your rental revenue.';
                    
                    // Update features list
                    const featuresList = document.querySelector('.auth-brand-features');
                    featuresList.innerHTML = `
                        <li>Access to thousands of potential customers</li>
                        <li>Easy vehicle and booking management</li>
                        <li>Secure payment processing</li>
                        <li>Dedicated vendor support team</li>
                    `;
                } else {
                    vendorFields.classList.remove('active');
                    document.getElementById('businessName').removeAttribute('required');
                    document.getElementById('vendorDestination').removeAttribute('required');
                    
                    // Restore original branding text
                    document.querySelector('.auth-brand-title').textContent = 'Begin Your Journey Today';
                    document.querySelector('.auth-brand-description').textContent = 'Join thousands of travelers and vendors who trust RideGo for unforgettable two-wheeled adventures.';
                    
                    // Restore original features list
                    const featuresList = document.querySelector('.auth-brand-features');
                    featuresList.innerHTML = `
                        <li>Access to 500+ bikes across 10+ destinations</li>
                        <li>Secure booking and verified vendors</li>
                        <li>Flexible rental plans for every budget</li>
                        <li>24/7 support and roadside assistance</li>
                    `;
                }
            });
        });

        // Form validation and submission
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Password validation
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (password !== confirmPassword) {
                alert('Passwords do not match! Please try again.');
                return;
            }

            if (password.length < 8) {
                alert('Password must be at least 8 characters long!');
                return;
            }

            // Collect form data
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());
            
            // Get selected role
            const role = document.querySelector('input[name="role"]:checked').value;
            data.role = role;
            
            console.log('Registration data:', data);
            
            // FIXED: Actually register the user using AuthService
            const result = AuthService.register(data);
            
            if (result.success) {
                const roleText = role === 'user' ? 'Traveler' : 'Vendor';
                alert(`Registration successful as ${roleText}!\n\nWelcome to RideGo, ${data.firstName}!\n\nYou can now login with your credentials.\n\nRedirecting to login page...`);
                
                // Redirect to login page
                window.location.href = 'login.html';
            } else {
                alert('Registration failed!\n\n' + result.error);
            }
        });

        // Phone number formatting (only digits, max 10)
        document.getElementById('phone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 10) {
                value = value.slice(0, 10);
            }
            e.target.value = value;
        });

        // Pincode validation (only digits, max 6)
        document.getElementById('pincode').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 6) {
                value = value.slice(0, 6);
            }
            e.target.value = value;
        });

        // Email validation on blur
        document.getElementById('email').addEventListener('blur', function() {
            const email = this.value;
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            
            if (email && !emailRegex.test(email)) {
                this.style.borderColor = 'var(--error)';
                alert('Please enter a valid email address');
            } else {
                this.style.borderColor = '';
            }
        });

        // Password strength indicator (optional enhancement)
        document.getElementById('password').addEventListener('input', function() {
            const password = this.value;
            let strength = 0;
            
            if (password.length >= 8) strength++;
            if (password.match(/[a-z]/) && password.match(/[A-Z]/)) strength++;
            if (password.match(/[0-9]/)) strength++;
            if (password.match(/[^a-zA-Z0-9]/)) strength++;
            
            // You can add visual feedback here based on strength value
        });
    </script>
</body>
</html>
